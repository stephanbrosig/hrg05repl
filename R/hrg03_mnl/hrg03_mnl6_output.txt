Model run by Brosig using Apollo 0.3.5 on R 4.4.3 for Windows.
Please acknowledge the use of Apollo by citing Hess & Palma (2019)
  DOI 10.1016/j.jocm.2019.100170
  www.ApolloChoiceModelling.com

Model name                                  : hrg03_mnl6
Model description                           : hrg03a_mnl6: hrg 2005 p. 355f: interactions2 (nl: cat)
Model run at                                : 2025-04-25 07:46:25.549489
Estimation method                           : bgw
Model diagnosis                             : Relative function convergence
Optimisation diagnosis                      : Maximum found
     hessian properties                     : Negative definite
     maximum eigenvalue                     : -1.199858
     reciprocal of condition number         : 0.000228377
Number of individuals                       : 795
Number of rows in database                  : 2369
Number of modelled outcomes                 : 2369

Number of cores used                        :  1 
Model without mixing

LL(start)                                   : -3300.44
LL at equal shares, LL(0)                   : -3284.13
LL at observed shares, LL(C)                : -4039.69
LL(final)                                   : -3199.52
Rho-squared vs equal shares                  :  0.0258 
Adj.Rho-squared vs equal shares              :  0.0215 
Rho-squared vs observed shares               :  0.208 
Adj.Rho-squared vs observed shares           :  0.2058 
AIC                                         :  6427.04 
BIC                                         :  6507.83 

Estimated parameters                        : 14
Time taken (hh:mm:ss)                       :  00:00:1.7 
     pre-estimation                         :  00:00:0.41 
     estimation                             :  00:00:0.16 
     post-estimation                        :  00:00:1.14 
Iterations                                  :  8  

Unconstrained optimisation.

Estimates:
              Estimate        s.e.   t.rat.(0)    Rob.s.e. Rob.t.rat.(0)
asc_cart      -0.08707     0.07600     -1.1457     0.08821       -0.9871
b_cost        -0.20668     0.02152     -9.6040     0.02143       -9.6451
asc_carnt      0.42028     0.07733      5.4351     0.08346        5.0358
asc_bus       -0.58527     0.23805     -2.4586     0.23997       -2.4389
b_fare1        0.18216     0.30648      0.5944     0.30716        0.5930
b_fare3       -0.78898     0.37083     -2.1276     0.37096       -2.1269
b_time10      -1.12909     0.38609     -2.9244     0.38779       -2.9116
b_time15      -0.77819     0.37059     -2.0999     0.37407       -2.0804
b_fr1tim10     1.15126     0.48399      2.3787     0.49347        2.3330
b_fr1tim15     0.90682     0.47412      1.9127     0.48561        1.8674
b_fr3tim10     2.50858     0.52588      4.7703     0.52387        4.7885
b_fr3tim15     2.21733     0.51154      4.3346     0.51451        4.3096
asc_tr        -0.03988     0.09385     -0.4250     0.09732       -0.4098
asc_bw         0.09093     0.08591      1.0583     0.09330        0.9745
asc_lr         0.00000          NA          NA          NA            NA


Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48



Classical covariance matrix:
              asc_cart      b_cost   asc_carnt     asc_bus     b_fare1     b_fare3    b_time10    b_time15  b_fr1tim10  b_fr1tim15  b_fr3tim10  b_fr3tim15      asc_tr      asc_bw
asc_cart      0.005776  3.7865e-04    0.003336    0.005260  1.8956e-04  2.1275e-04   4.302e-06  1.2793e-04  -6.674e-06 -1.3176e-04 -1.3641e-04 -1.6934e-04    0.003860    0.003738
b_cost      3.7865e-04  4.6310e-04 -5.5244e-04    0.001129  1.7249e-04  1.9976e-04   4.356e-05  1.5488e-04   1.573e-05 -1.2922e-04 -1.2326e-04 -1.5840e-04  -3.030e-06   1.248e-05
asc_carnt     0.003336 -5.5244e-04    0.005980    0.002939 -1.5439e-04 -2.0478e-04   1.742e-05 -1.4158e-04  -4.269e-05  1.2584e-04  1.2331e-04  2.1106e-04    0.003866    0.003713
asc_bus       0.005260    0.001129    0.002939    0.056665    -0.04911    -0.04907    -0.04944    -0.04918     0.04956     0.04921     0.04924     0.04918    0.004751    0.004221
b_fare1     1.8956e-04  1.7249e-04 -1.5439e-04   -0.049113     0.09393     0.04961     0.04955     0.04959    -0.09385    -0.09391    -0.04958    -0.04959  -6.903e-05 -1.3935e-04
b_fare3     2.1275e-04  1.9976e-04 -2.0478e-04   -0.049070     0.04961     0.13751     0.04956     0.04962    -0.04952    -0.04959    -0.13747    -0.13750 -2.9734e-04   4.391e-05
b_time10     4.302e-06   4.356e-05   1.742e-05   -0.049438     0.04955     0.04956     0.14906     0.04955    -0.14905    -0.04954    -0.14907    -0.04956 -1.4042e-04   1.242e-05
b_time15    1.2793e-04  1.5488e-04 -1.4158e-04   -0.049181     0.04959     0.04962     0.04955     0.13733    -0.04952    -0.13730    -0.04958    -0.13734 -2.8847e-04  1.0462e-04
b_fr1tim10  -6.674e-06   1.573e-05  -4.269e-05    0.049556    -0.09385    -0.04952    -0.14905    -0.04952     0.23424     0.09385     0.14905     0.04951 -1.0795e-04  1.5307e-04
b_fr1tim15 -1.3176e-04 -1.2922e-04  1.2584e-04    0.049212    -0.09391    -0.04959    -0.04954    -0.13730     0.09385     0.22479     0.04957     0.13730  -1.190e-05  1.0750e-04
b_fr3tim10 -1.3641e-04 -1.2326e-04  1.2331e-04    0.049238    -0.04958    -0.13747    -0.14907    -0.04958     0.14905     0.04957     0.27655     0.13745  1.0336e-04   4.045e-05
b_fr3tim15 -1.6934e-04 -1.5840e-04  2.1106e-04    0.049185    -0.04959    -0.13750    -0.04956    -0.13734     0.04951     0.13730     0.13745     0.26167  4.2340e-04 -2.5204e-04
asc_tr        0.003860  -3.030e-06    0.003866    0.004751  -6.903e-05 -2.9734e-04 -1.4042e-04 -2.8847e-04 -1.0795e-04  -1.190e-05  1.0336e-04  4.2340e-04    0.008807    0.003234
asc_bw        0.003738   1.248e-05    0.003713    0.004221 -1.3935e-04   4.391e-05   1.242e-05  1.0462e-04  1.5307e-04  1.0750e-04   4.045e-05 -2.5204e-04    0.003234    0.007381

Robust covariance matrix:
              asc_cart      b_cost   asc_carnt     asc_bus     b_fare1     b_fare3    b_time10    b_time15  b_fr1tim10  b_fr1tim15  b_fr3tim10  b_fr3tim15      asc_tr      asc_bw
asc_cart      0.007781  6.0573e-04    0.004449    0.005982 -4.0530e-04   -0.001864   -0.003545  4.4218e-04    0.003095  -9.965e-05    0.004576  7.1724e-04    0.004177    0.004547
b_cost      6.0573e-04  4.5917e-04 -3.0489e-04    0.001728 -2.2434e-04 -3.0153e-04 -5.6668e-04 -1.0724e-04  9.2110e-04   2.418e-05  3.4852e-04  2.5435e-04   8.032e-05  1.6546e-04
asc_carnt     0.004449 -3.0489e-04    0.006965    0.001627  7.9289e-04  -4.692e-05   -0.001262    0.001094  5.7989e-04   -0.001262    0.002455 -5.9721e-04    0.003673    0.004082
asc_bus       0.005982    0.001728    0.001627    0.057586    -0.05020   -0.051682   -0.053935   -0.049520    0.058295    0.049495    0.054844    0.051363    0.003514    0.004624
b_fare1    -4.0530e-04 -2.2434e-04  7.9289e-04   -0.050204     0.09434    0.049620    0.049658    0.054132   -0.097961   -0.098906   -0.046321   -0.054396  2.3787e-04 -2.5235e-04
b_fare3      -0.001864 -3.0153e-04  -4.692e-05   -0.051682     0.04962    0.137613    0.047892    0.049618   -0.051492   -0.041524   -0.136018   -0.137964   -0.001286   -0.002248
b_time10     -0.003545 -5.6668e-04   -0.001262   -0.053935     0.04966    0.047892    0.150383    0.049710   -0.154013   -0.048450   -0.148530   -0.048268   -0.003331   -0.002652
b_time15    4.4218e-04 -1.0724e-04    0.001094   -0.049520     0.05413    0.049618    0.049710    0.139925   -0.057725   -0.144466   -0.050385   -0.140157  9.1967e-04   -0.001313
b_fr1tim10    0.003095  9.2110e-04  5.7989e-04    0.058295    -0.09796   -0.051492   -0.154013   -0.057725    0.243515    0.101161    0.148711    0.060687    0.003409    0.003291
b_fr1tim15  -9.965e-05   2.418e-05   -0.001262    0.049495    -0.09891   -0.041524   -0.048450   -0.144466    0.101161    0.235813    0.037528    0.136416 -8.7267e-04    0.001678
b_fr3tim10    0.004576  3.4852e-04    0.002455    0.054844    -0.04632   -0.136018   -0.148530   -0.050385    0.148711    0.037528    0.274440    0.136943    0.005167    0.005656
b_fr3tim15  7.1724e-04  2.5435e-04 -5.9721e-04    0.051363    -0.05440   -0.137964   -0.048268   -0.140157    0.060687    0.136416    0.136943    0.264723    0.001499    0.002671
asc_tr        0.004177   8.032e-05    0.003673    0.003514  2.3787e-04   -0.001286   -0.003331  9.1967e-04    0.003409 -8.7267e-04    0.005167    0.001499    0.009472    0.003737
asc_bw        0.004547  1.6546e-04    0.004082    0.004624 -2.5235e-04   -0.002248   -0.002652   -0.001313    0.003291    0.001678    0.005656    0.002671    0.003737    0.008705

Classical correlation matrix:
              asc_cart      b_cost   asc_carnt     asc_bus     b_fare1     b_fare3    b_time10    b_time15  b_fr1tim10  b_fr1tim15  b_fr3tim10  b_fr3tim15      asc_tr      asc_bw
asc_cart      1.000000    0.231520    0.567593      0.2908    0.008138    0.007549  1.4660e-04    0.004542 -1.8144e-04   -0.003657   -0.003413   -0.004356    0.541139    0.572454
b_cost        0.231520    1.000000   -0.331980      0.2204    0.026153    0.025033    0.005243    0.019421    0.001510   -0.012665   -0.010891   -0.014389   -0.001501    0.006752
asc_carnt     0.567593   -0.331980    1.000000      0.1597   -0.006515   -0.007142  5.8365e-04   -0.004941   -0.001141    0.003432    0.003032    0.005336    0.532737    0.558929
asc_bus       0.290772    0.220394    0.159679      1.0000   -0.673197   -0.555886   -0.537924   -0.557502    0.430138    0.436043    0.393330    0.403919    0.212647    0.206397
b_fare1       0.008138    0.026153   -0.006515     -0.6732    1.000000    0.436526    0.418758    0.436629   -0.632731   -0.646277   -0.307638   -0.316296   -0.002400   -0.005293
b_fare3       0.007549    0.025033   -0.007142     -0.5559    0.436526    1.000000    0.346147    0.361042   -0.275904   -0.282038   -0.704926   -0.724863   -0.008544    0.001378
b_time10    1.4660e-04    0.005243  5.8365e-04     -0.5379    0.418758    0.346147    1.000000    0.346349   -0.797637   -0.270654   -0.734191   -0.250915   -0.003875  3.7429e-04
b_time15      0.004542    0.019421   -0.004941     -0.5575    0.436629    0.361042    0.346349    1.000000   -0.276077   -0.781465   -0.254395   -0.724504   -0.008294    0.003286
b_fr1tim10 -1.8144e-04    0.001510   -0.001141      0.4301   -0.632731   -0.275904   -0.797637   -0.276077    1.000000    0.409013    0.585606    0.199970   -0.002377    0.003681
b_fr1tim15   -0.003657   -0.012665    0.003432      0.4360   -0.646277   -0.282038   -0.270654   -0.781465    0.409013    1.000000    0.198804    0.566118 -2.6738e-04    0.002639
b_fr3tim10   -0.003413   -0.010891    0.003032      0.3933   -0.307638   -0.704926   -0.734191   -0.254395    0.585606    0.198804    1.000000    0.510972    0.002094  8.9533e-04
b_fr3tim15   -0.004356   -0.014389    0.005336      0.4039   -0.316296   -0.724863   -0.250915   -0.724504    0.199970    0.566118    0.510972    1.000000    0.008820   -0.005735
asc_tr        0.541139   -0.001501    0.532737      0.2126   -0.002400   -0.008544   -0.003875   -0.008294   -0.002377 -2.6738e-04    0.002094    0.008820    1.000000    0.401092
asc_bw        0.572454    0.006752    0.558929      0.2064   -0.005293    0.001378  3.7429e-04    0.003286    0.003681    0.002639  8.9533e-04   -0.005735    0.401092    1.000000

Robust correlation matrix:
              asc_cart      b_cost   asc_carnt     asc_bus     b_fare1     b_fare3    b_time10    b_time15  b_fr1tim10  b_fr1tim15  b_fr3tim10  b_fr3tim15      asc_tr      asc_bw
asc_cart      1.000000    0.320456    0.604364     0.28258   -0.014959   -0.056952    -0.10363     0.01340     0.07110   -0.002326     0.09902     0.01580    0.486512    0.552487
b_cost        0.320456    1.000000   -0.170487     0.33602   -0.034086   -0.037933    -0.06819    -0.01338     0.08711    0.002323     0.03105     0.02307    0.038516    0.082758
asc_carnt     0.604364   -0.170487    1.000000     0.08125    0.030931   -0.001516    -0.03899     0.03505     0.01408   -0.031139     0.05616    -0.01391    0.452191    0.524270
asc_bus       0.282580    0.336021    0.081251     1.00000   -0.681118   -0.580569    -0.57958    -0.55166     0.49228    0.424735     0.43626     0.41601    0.150469    0.206530
b_fare1      -0.014959   -0.034086    0.030931    -0.68112    1.000000    0.435482     0.41690     0.47114    -0.64630   -0.663098    -0.28787    -0.34420    0.007957   -0.008806
b_fare3      -0.056952   -0.037933   -0.001516    -0.58057    0.435482    1.000000     0.33292     0.35757    -0.28129   -0.230505    -0.69991    -0.72284   -0.035622   -0.064941
b_time10     -0.103631   -0.068195   -0.038985    -0.57958    0.416899    0.332918     1.00000     0.34269    -0.80481   -0.257284    -0.73112    -0.24191   -0.088267   -0.073297
b_time15      0.013401   -0.013379    0.035050    -0.55166    0.471139    0.357569     0.34269     1.00000    -0.31272   -0.795309    -0.25712    -0.72824    0.025262   -0.037611
b_fr1tim10    0.071098    0.087108    0.014081     0.49228   -0.646296   -0.281286    -0.80481    -0.31272     1.00000    0.422151     0.57525     0.23902    0.070971    0.071486
b_fr1tim15   -0.002326    0.002323   -0.031139     0.42474   -0.663098   -0.230505    -0.25728    -0.79531     0.42215    1.000000     0.14752     0.54599   -0.018465    0.037038
b_fr3tim10    0.099020    0.031047    0.056157     0.43626   -0.287871   -0.699914    -0.73112    -0.25712     0.57525    0.147518     1.00000     0.50807    0.101344    0.115715
b_fr3tim15    0.015803    0.023070   -0.013908     0.41601   -0.344199   -0.722836    -0.24191    -0.72824     0.23902    0.545992     0.50807     1.00000    0.029936    0.055648
asc_tr        0.486512    0.038516    0.452191     0.15047    0.007957   -0.035622    -0.08827     0.02526     0.07097   -0.018465     0.10134     0.02994    1.000000    0.411539
asc_bw        0.552487    0.082758    0.524270     0.20653   -0.008806   -0.064941    -0.07330    -0.03761     0.07149    0.037038     0.11571     0.05565    0.411539    1.000000

Changes in parameter estimates from starting values:
               Initial    Estimate  Difference
asc_cart      -0.10000    -0.08707    0.012927
b_cost        -0.20000    -0.20668   -0.006676
asc_carnt      0.40000     0.42028    0.020278
asc_bus        0.10000    -0.58527   -0.685268
b_fare1        0.10000     0.18216    0.082157
b_fare3        0.10000    -0.78898   -0.888983
b_time10       0.10000    -1.12909   -1.229088
b_time15       0.10000    -0.77819   -0.878191
b_fr1tim10     0.10000     1.15126    1.051262
b_fr1tim15     0.10000     0.90682    0.806823
b_fr3tim10     0.10000     2.50858    2.408576
b_fr3tim15     0.10000     2.21733    2.117332
asc_tr         0.01000    -0.03988   -0.049884
asc_bw        -0.04000     0.09093    0.130925
asc_lr         0.00000     0.00000    0.000000

Settings and functions used in model definition:

apollo_control
--------------
                       Value                                                   
modelName              "hrg03_mnl6"                                            
modelDescr             "hrg03a_mnl6: hrg 2005 p. 355f: interactions2 (nl: cat)"
indivID                "id"                                                    
outputDirectory        "hrg03_mnl/"                                            
panelData              "TRUE"                                                  
debug                  "FALSE"                                                 
nCores                 "1"                                                     
workInLogs             "FALSE"                                                 
seed                   "13"                                                    
mixing                 "FALSE"                                                 
HB                     "FALSE"                                                 
noValidation           "FALSE"                                                 
noDiagnostics          "FALSE"                                                 
calculateLLC           "TRUE"                                                  
analyticHessian        "FALSE"                                                 
memorySaver            "FALSE"                                                 
analyticGrad           "TRUE"                                                  
analyticGrad_manualSet "FALSE"                                                 
overridePanel          "FALSE"                                                 
preventOverridePanel   "FALSE"                                                 
noModification         "FALSE"                                                 

Hessian routines attempted
--------------------------
numerical jacobian of LL analytical gradient

Scaling used in computing Hessian
---------------------------------
                Value
asc_cart   0.08707312
b_cost     0.20667643
asc_carnt  0.42027788
asc_bus    0.58526833
b_fare1    0.18215744
b_fare3    0.78898262
b_time10   1.12908775
b_time15   0.77819068
b_fr1tim10 1.15126174
b_fr1tim15 0.90682282
b_fr3tim10 2.50857590
b_fr3tim15 2.21733198
asc_tr     0.03988417
asc_bw     0.09092549


apollo_probabilities
----------------------
function(apollo_beta, apollo_inputs, functionality="estimate"){
    
  ### Attach inputs and detach after function exit
  apollo_attach(apollo_beta, apollo_inputs)
  on.exit(apollo_detach(apollo_beta, apollo_inputs))

  ### Create list of probabilities P
  P = list()

  ### List of utilities: these must use the same names as in mnl_settings, order is irrelevant

V <- list()                                                                                  
V[["CART"]]  <- asc_cart   + b_cost * fuel_CART 
V[["CARNT"]] <- asc_carnt  + b_cost * fuel_CARNT
V[["BUS"]]   <- asc_bus    + b_fare1 * fare_BUS1 + b_fare3 * fare_BUS3 + 
                             b_time10 * time_BUS10 + b_time15 * time_BUS15 + 
                             b_fr1tim10 * fr1tim10_BUS + b_fr1tim15 * fr1tim15_BUS + 
                             b_fr3tim10 * fr3tim10_BUS + b_fr3tim15 * fr3tim15_BUS
V[["TR"]]    <- asc_tr     + b_cost * fare_TR   
V[["BW"]]    <- asc_bw     + b_cost * fare_BW   
V[["LR"]]    <- asc_lr     + b_cost * fare_LR   

  
  ### Define settings for MNL model component
  mnl_settings = list(
    alternatives  = c(CART=1, CARNT=2, TR=3, LR=4, BW=5, BUS=6), 
    avail         = list(CART=avail_CART, CARNT=avail_CARNT, TR=avail_TR, BW=avail_BW, LR=avail_LR, BUS=avail_BUS), 
    choiceVar     = choice_newn,
    utilities     = V
  )
  
  ### Compute probabilities using MNL model
  P[["model"]] = apollo_mnl(mnl_settings, functionality)
  
  ### Take product across observation for same individual
  P = apollo_panelProd(P, apollo_inputs, functionality)
  
  ### Prepare and return outputs of function
  P = apollo_prepareProb(P, apollo_inputs, functionality)
  return(P)
}
