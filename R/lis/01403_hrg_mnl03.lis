Codefile:01403_hrg_mnl03.r 


codebookentries('altij',asm)

altij[] (Length:9476, # of nonmissing elements:9476)
  Frequency PctShare LevelCode LevelText
1      2369       25         1      CART
2      2369       25         2     CARNT
3      1039       11         3       BUS
4      1089       11         4        TR
5      1280       14         5        BW
6      1330       14         6        LR
Apollo ignition sequence completed
All checks on apollo_control completed.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl3_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 4.452992283e+03
     1     4 3.725531642e+03 1.634e-01 1.228e-01 1.02e-01   G   8.01e-01
     2     5 3.278506246e+03 1.200e-01 9.138e-02 3.76e-01   G   0.00e+00
     3     6 3.214837372e+03 1.942e-02 2.092e-02 1.00e+00   S   0.00e+00
     4     7 3.214245682e+03 1.840e-04 1.810e-04 1.10e-01   S   0.00e+00
     5     8 3.214240591e+03 1.584e-06 1.534e-06 6.96e-03   S   0.00e+00
     6     9 3.214240549e+03 1.320e-08 1.317e-08 9.65e-04   S   0.00e+00
     7    10 3.214240549e+03 1.568e-11 1.603e-11 1.26e-05   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
             Estimate     BHHH se BHH t-ratio (0)
asc_cart     -0.43353     0.17425         -2.4881
b_cart       -0.09766     0.05753         -1.6976
asc_carnt    -0.16668     0.26164         -0.6371
b_carnt      -0.09244     0.05686         -1.6257
asc_bus      -0.18886     0.19780         -0.9548
b_bus        -0.17878     0.04784         -3.7370
asc_tr       -0.15245     0.18358         -0.8304
b_tr         -0.21490     0.04443         -4.8365
asc_bw        0.11530     0.17735          0.6501
b_bw         -0.26643     0.04141         -6.4332
asc_lr        0.00000          NA              NA
b_lr         -0.25775     0.04186         -6.1576

Final LL: -3214.2405

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%..100%
Negative definite Hessian with maximum eigenvalue: -9.208252
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170


apollo_modelOutput(model)
Model run by Brosig using Apollo 0.3.5 on R 4.4.3 for Windows.
Please acknowledge the use of Apollo by citing Hess & Palma (2019)
  DOI 10.1016/j.jocm.2019.100170
  www.ApolloChoiceModelling.com

Model name                                  : 01403_hrg_mnl3
Model description                           : 01403a_hrg_mnl3: HRG05 LR-Test comparing two models (335ff)
Model run at                                : 2025-04-08 10:35:09.725577
Estimation method                           : bgw
Model diagnosis                             : Relative function convergence
Optimisation diagnosis                      : Maximum found
     hessian properties                     : Negative definite
     maximum eigenvalue                     : -9.208252
     reciprocal of condition number         : 0.0010348
Number of individuals                       : 795
Number of rows in database                  : 2369
Number of modelled outcomes                 : 2369

Number of cores used                        :  1 
Model without mixing

LL(start)                                   : -4452.99
LL at equal shares, LL(0)                   : -3284.13
LL at observed shares, LL(C)                : -4039.69
LL(final)                                   : -3214.24
Rho-squared vs equal shares                  :  0.0213 
Adj.Rho-squared vs equal shares              :  0.0179 
Rho-squared vs observed shares               :  0.2043 
Adj.Rho-squared vs observed shares           :  0.2028 
AIC                                         :  6450.48 
BIC                                         :  6513.95 

Estimated parameters                        : 11
Time taken (hh:mm:ss)                       :  00:00:1 
     pre-estimation                         :  00:00:0.27 
     estimation                             :  00:00:0.13 
     post-estimation                        :  00:00:0.6 
Iterations                                  :  7  

Unconstrained optimisation.

Estimates:
             Estimate        s.e.   t.rat.(0)    Rob.s.e. Rob.t.rat.(0)
asc_cart     -0.43353     0.17456     -2.4835     0.17012       -2.5484
b_cart       -0.09766     0.05795     -1.6853     0.05387       -1.8129
asc_carnt    -0.16668     0.26069     -0.6394     0.23914       -0.6970
b_carnt      -0.09244     0.05647     -1.6370     0.04999       -1.8491
asc_bus      -0.18886     0.19431     -0.9719     0.19644       -0.9614
b_bus        -0.17878     0.04576     -3.9064     0.04220       -4.2369
asc_tr       -0.15245     0.18562     -0.8213     0.17332       -0.8796
b_tr         -0.21490     0.04577     -4.6952     0.04415       -4.8678
asc_bw        0.11530     0.17867      0.6453     0.16835        0.6849
b_bw         -0.26643     0.04169     -6.3912     0.03927       -6.7844
asc_lr        0.00000          NA          NA          NA            NA
b_lr         -0.25775     0.04182     -6.1630     0.03983       -6.4721


Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


 num -3220
 num -3214


diff <- 2 * (LL1 - LL2)
[1] -11.81826


apollo_lrTest('01403_hrg_mnl/01403_hrg_mnl01', model)
                      LL par
01403_hrg_mnl01 -3220.15   6
01403_hrg_mnl3  -3214.24  11
Difference          5.91   5

Likelihood ratio test-value:    11.82 
Degrees of freedom:             5 
Likelihood ratio test p-value:  0.03734 
INFORMATION: The p-value from the test is returned invisibly as an output from this function. Calling the function via result=apollo_lrTest(...) will save this output in an object called result (or otherwise named object). 
Apollo ignition sequence completed
All checks on apollo_control completed.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl4_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 3.264382464e+03
     1     3 3.245680416e+03 5.729e-03 5.916e-03 5.43e-02   G   2.36e+00
     2     4 3.227185849e+03 5.698e-03 6.052e-03 1.44e-01   G   3.87e-01
     3     5 3.218049630e+03 2.831e-03 2.804e-03 3.12e-01   S   0.00e+00
     4     6 3.217960633e+03 2.766e-05 2.859e-05 2.12e-02   S   0.00e+00
     5     7 3.217960441e+03 5.974e-08 6.299e-08 7.27e-04   G   0.00e+00
     6     8 3.217960439e+03 4.143e-10 4.055e-10 5.97e-05   S   0.00e+00
     7     9 3.217960439e+03 1.587e-12 1.516e-12 3.22e-06   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
              Estimate     BHHH se BHH t-ratio (0)
asc_cart      -0.06486     0.07561         -0.8578
b_cost        -0.18203     0.02125         -8.5663
asc_carnt      0.39187     0.07938          4.9366
asc_bus        0.02057     0.09969          0.2063
asc_tr        -0.04100     0.09423         -0.4351
asc_bw        -0.95673     0.15513         -6.1672
b_fare_bw1     1.05038     0.16753          6.2699
b_fare_bw3     0.38560     0.17771          2.1698
b_fare_bw5     0.00000          NA              NA
asc_lr         0.00000          NA              NA

Final LL: -3217.9604

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%.100%
Negative definite Hessian with maximum eigenvalue: -15.700759
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170
Apollo ignition sequence completed
All checks on apollo_control completed.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl4_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 3.264382464e+03
     1     3 3.245680416e+03 5.729e-03 5.916e-03 5.43e-02   G   2.36e+00
     2     4 3.227185849e+03 5.698e-03 6.052e-03 1.44e-01   G   3.87e-01
     3     5 3.218049630e+03 2.831e-03 2.804e-03 3.12e-01   S   0.00e+00
     4     6 3.217960633e+03 2.766e-05 2.859e-05 2.12e-02   S   0.00e+00
     5     7 3.217960441e+03 5.974e-08 6.299e-08 7.27e-04   G   0.00e+00
     6     8 3.217960439e+03 4.143e-10 4.055e-10 5.97e-05   S   0.00e+00
     7     9 3.217960439e+03 1.587e-12 1.516e-12 3.22e-06   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
              Estimate     BHHH se BHH t-ratio (0)
asc_cart      -0.06486     0.07561         -0.8578
b_cost        -0.18203     0.02125         -8.5663
asc_carnt      0.39187     0.07938          4.9366
asc_bus        0.02057     0.09969          0.2063
asc_tr        -0.04100     0.09423         -0.4351
asc_bw        -0.95673     0.15513         -6.1672
b_fare_bw1     1.05038     0.16753          6.2699
b_fare_bw3     0.38560     0.17771          2.1698
b_fare_bw5     0.00000          NA              NA
asc_lr         0.00000          NA              NA

Final LL: -3217.9604

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%.100%
Negative definite Hessian with maximum eigenvalue: -15.700759
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170
Apollo ignition sequence completed
All checks on apollo_control completed.
WARNING: Your database contains some entries that are NA. This may well be intentional, but be advised that if these entries are used in your model, the behaviour may be unexpected. 
WARNING: Your database contains variable(s) "drivlic" codified as factors. Apollo does not support factors, and using them inside apollo_probabilities may lead to NA values in the loglikelihood. If you want to use these
  variables, we recommend manually transforming them into numeric variables.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl5_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 4.435471591e+03
     1     4 4.085653118e+03 7.887e-02 6.444e-02 3.44e-02   G   2.26e+00
     2     5 3.667356950e+03 1.024e-01 6.513e-02 1.13e-01   G   0.00e+00
     3     6 3.353625123e+03 8.555e-02 5.947e-02 2.32e-01   S   0.00e+00
     4     7 3.241727942e+03 3.337e-02 2.308e-02 3.69e-01   S   0.00e+00
     5     8 3.218100136e+03 7.289e-03 7.393e-03 4.02e-01   S   0.00e+00
     6     9 3.218025662e+03 2.314e-05 2.275e-05 1.41e-02   S   0.00e+00
     7    10 3.218025372e+03 9.019e-08 8.788e-08 8.09e-04   S   0.00e+00
     8    11 3.218025371e+03 2.907e-10 2.847e-10 5.44e-05   S   0.00e+00
     9    12 3.218025371e+03 8.419e-13 8.621e-13 2.35e-06   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
             Estimate     BHHH se BHH t-ratio (0)
asc_cart     -0.08196     0.07520         -1.0899
b_cost       -0.20182     0.01884        -10.7134
asc_carnt     0.31084     0.09261          3.3564
b_vehlic      0.02305     0.01122          2.0549
asc_bus       0.02079     0.09961          0.2088
asc_tr       -0.04165     0.09430         -0.4417
asc_bw        0.09340     0.08728          1.0700
asc_lr        0.00000          NA              NA

Final LL: -3218.0254

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%....100%
Negative definite Hessian with maximum eigenvalue: -41.826738
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170
Apollo ignition sequence completed
All checks on apollo_control completed.
WARNING: Your database contains some entries that are NA. This may well be intentional, but be advised that if these entries are used in your model, the behaviour may be unexpected. 
WARNING: Your database contains variable(s) "drivlic" codified as factors. Apollo does not support factors, and using them inside apollo_probabilities may lead to NA values in the loglikelihood. If you want to use these
  variables, we recommend manually transforming them into numeric variables.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl5_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 4.435471591e+03
     1     4 4.085653118e+03 7.887e-02 6.444e-02 3.44e-02   G   2.26e+00
     2     5 3.667356950e+03 1.024e-01 6.513e-02 1.13e-01   G   0.00e+00
     3     6 3.353625123e+03 8.555e-02 5.947e-02 2.32e-01   S   0.00e+00
     4     7 3.241727942e+03 3.337e-02 2.308e-02 3.69e-01   S   0.00e+00
     5     8 3.218100136e+03 7.289e-03 7.393e-03 4.02e-01   S   0.00e+00
     6     9 3.218025662e+03 2.314e-05 2.275e-05 1.41e-02   S   0.00e+00
     7    10 3.218025372e+03 9.019e-08 8.788e-08 8.09e-04   S   0.00e+00
     8    11 3.218025371e+03 2.907e-10 2.847e-10 5.44e-05   S   0.00e+00
     9    12 3.218025371e+03 8.419e-13 8.621e-13 2.35e-06   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
             Estimate     BHHH se BHH t-ratio (0)
asc_cart     -0.08196     0.07520         -1.0899
b_cost       -0.20182     0.01884        -10.7134
asc_carnt     0.31084     0.09261          3.3564
b_vehlic      0.02305     0.01122          2.0549
asc_bus       0.02079     0.09961          0.2088
asc_tr       -0.04165     0.09430         -0.4417
asc_bw        0.09340     0.08728          1.0700
asc_lr        0.00000          NA              NA

Final LL: -3218.0254

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%....100%
Negative definite Hessian with maximum eigenvalue: -41.826738
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170
Apollo ignition sequence completed
All checks on apollo_control completed.
WARNING: Your database contains some entries that are NA. This may well be intentional, but be advised that if these entries are used in your model, the behaviour may be unexpected. 
WARNING: Your database contains variable(s) "drivlic" codified as factors. Apollo does not support factors, and using them inside apollo_probabilities may lead to NA values in the loglikelihood. If you want to use these
  variables, we recommend manually transforming them into numeric variables.
All checks on database completed.


model = apollo_estimate(apollo_beta, apollo_fixed, apollo_probabilities, apollo_inputs)
Preparing user-defined functions.

Testing likelihood function...

Overview of choices for MNL model component :
                                    CART   CARNT      TR      LR      BW     BUS
Times available                  2369.00 2369.00 1089.00 1330.00 1280.00 1039.00
Times chosen                      600.00  658.00  243.00  305.00  319.00  244.00
Percentage chosen overall          25.33   27.78   10.26   12.87   13.47   10.30
Percentage chosen when available   25.33   27.78   22.31   22.93   24.92   23.48


Pre-processing likelihood function...

Testing influence of parameters
Starting main estimation

BGW using analytic model derivatives supplied by caller...


Iterates will be written to: 
 01403_hrg_mnl/01403_hrg_mnl6_iterations.csv
    it    nf     F            RELDF    PRELDF    RELDX    MODEL stppar
     0     1 3.300442649e+03
     1     3 3.243914823e+03 1.713e-02 1.771e-02 9.49e-02   G   2.39e+00
     2     4 3.212730172e+03 9.613e-03 1.073e-02 1.87e-01   G   3.92e-01
     3     5 3.201976378e+03 3.347e-03 3.379e-03 1.56e-01   S   8.35e-02
     4     6 3.199585296e+03 7.468e-04 7.065e-04 1.30e-01   S   3.34e-03
     5     7 3.199521389e+03 1.997e-05 1.956e-05 2.78e-02   S   0.00e+00
     6     8 3.199521231e+03 4.928e-08 4.680e-08 9.98e-04   G   0.00e+00
     7     9 3.199521230e+03 4.676e-10 4.271e-10 7.68e-05   G   0.00e+00
     8    10 3.199521230e+03 7.354e-12 7.535e-12 1.33e-05   S   0.00e+00

***** Relative function convergence *****

Estimated parameters with approximate standard errors from BHHH matrix:
              Estimate     BHHH se BHH t-ratio (0)
asc_cart      -0.08707     0.07543         -1.1543
b_cost        -0.20668     0.02111         -9.7911
asc_carnt      0.42028     0.07939          5.2942
asc_bus       -0.58527     0.23523         -2.4881
b_fare1        0.18216     0.30624          0.5948
b_fare3       -0.78898     0.37102         -2.1265
b_time10      -1.12909     0.38482         -2.9341
b_time15      -0.77819     0.36749         -2.1176
b_fr1tim10     1.15126     0.48250          2.3860
b_fr1tim15     0.90682     0.47199          1.9213
b_fr3tim10     2.50858     0.52536          4.7749
b_fr3tim15     2.21733     0.51001          4.3476
asc_tr        -0.03988     0.09454         -0.4219
asc_bw         0.09093     0.08736          1.0409
asc_lr         0.00000          NA              NA

Final LL: -3199.5212

Calculating log-likelihood at equal shares (LL(0)) for applicable models...
Calculating log-likelihood at observed shares from estimation data (LL(c)) for applicable models...
Calculating LL of each model component...
Calculating other model fit measures
Computing covariance matrix using numerical jacobian of analytical gradient.
 0%....25%....50%....75%...100%
Negative definite Hessian with maximum eigenvalue: -1.199858
Computing score matrix...

Your model was estimated using the BGW algorithm. Please acknowledge this by citing Bunch et al. (1993) - doi.org/10.1145/151271.151279

Please acknowledge the use of Apollo by citing Hess & Palma (2019) - doi.org/10.1016/j.jocm.2019.100170
